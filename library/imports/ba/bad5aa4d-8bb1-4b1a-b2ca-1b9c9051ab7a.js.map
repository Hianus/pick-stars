{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Player.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Player extends cc.Component {\r\n\r\n    @property(cc.Label)\r\n    label: cc.Label = null;\r\n\r\n    //跳跃高度\r\n    @property(cc.Integer)\r\n    private jumpHeight:number = 0;\r\n    //跳跃持续时间\r\n    @property(cc.Integer)\r\n    private jumpDuration:number = 0;\r\n    //最大移动速度\r\n    @property(cc.Integer)\r\n    private maxMoveSpeed:number = 0;\r\n    //加速度\r\n    @property(cc.Integer)\r\n    private accel:number = 0;\r\n    //跳跃音效\r\n    @property(cc.AudioClip)\r\n    private jumpAudio:cc.AudioClip = null;\r\n\r\n    @property\r\n    text: string = 'hello';\r\n\r\n\r\n    private xSpeed:number = 0;\r\n    private accLeft:boolean = false;\r\n    private accRight:boolean = false;\r\n    private jumpAction:cc.Action = null;\r\n\r\n    //player跳跃方法\r\n    private setJumpAction() {\r\n        let jumpUp = cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        let jumpDown = cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n        let callback = cc.callFunc(this.playJumpAudio,this);\r\n        return cc.repeatForever(cc.sequence(jumpUp,jumpDown));\r\n    };\r\n    private playJumpAudio(){\r\n        //调用声音引擎播放声音\r\n        cc.audioEngine.play(this.jumpAudio as any,false,1)\r\n    }\r\n    private addEventListeners(){\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n        // cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_START, this.onScreenTouchStart,this);\r\n        // cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_CANCEL, this.onScreenTouchEnd, this);\r\n        // cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_END, this.onScreenTouchEnd,this);\r\n    }\r\n    // private onScreenTouchStart(event: cc.Event.EventTouch) {\r\n    //     if (event.getLocationX() > cc.winSize.width/2) {\r\n    //         this.moveRight();\r\n    //     } else {\r\n    //         this.moveLeft();\r\n    //     }\r\n    // }\r\n\r\n    // private onScreenTouchEnd() {\r\n    //     this.stopMove();\r\n    // }\r\n    private moveLeft(){\r\n        this.accLeft = true;\r\n        this.accRight = false;\r\n    }\r\n    private moveRight(){\r\n        this.accLeft = false;\r\n        this.accRight = true;\r\n    }\r\n    private stopMove(){\r\n        this.accLeft = false;\r\n        this.accRight = false;\r\n    }\r\n    private onKeyDown(event){\r\n        switch(event.keyCode){\r\n            case cc.KEY.a:\r\n            case cc.KEY.left:\r\n                this.moveLeft();\r\n                this.accLeft = true;\r\n                break;\r\n            case cc.KEY.d:\r\n            case cc.KEY.right:\r\n                this.moveRight();\r\n                this.accRight = true;\r\n                break;\r\n        }\r\n    };\r\n    private onKeyUp(event){\r\n        switch(event.keyCode){\r\n            case cc.KEY.a:\r\n            case cc.KEY.left:\r\n                this.stopMove();\r\n                this.accLeft = false;\r\n                break;\r\n            case cc.KEY.d:\r\n            case cc.KEY.right:\r\n                this.stopMove();\r\n                this.accRight = false;\r\n                break;\r\n        }\r\n    }\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        //初始化跳跃动作\r\n        this.jumpAction = this.setJumpAction();\r\n        this.node.runAction(this.jumpAction);\r\n        //加速度方向开关\r\n        this.accLeft = false;\r\n        this.accRight = false;\r\n        //当前水平方向速度\r\n        this.xSpeed = 0;\r\n        //初始化输入监听\r\n        this.addEventListeners();\r\n    }\r\n    onDestroy(){\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    }\r\n    //start () {}\r\n    update(dt:number){\r\n        //根据当前加速度方向每帧更新速度\r\n        if(this.accLeft){\r\n            this.xSpeed -= this.accel * dt;\r\n        }else if(this.accRight){\r\n            this.xSpeed += this.accel * dt;\r\n        }\r\n\r\n        console.log(this.xSpeed);\r\n\r\n        //限制角色的速度不能超过最大值\r\n        if(Math.abs(this.xSpeed) > this.maxMoveSpeed){\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed/Math.abs(this.xSpeed);\r\n        }\r\n        //根据当前速度更新角色位置\r\n        this.node.x += this.xSpeed * dt;\r\n        if (this.node.x - this.node.width/2 <= -this.node.parent.width / 2) {\r\n            this.xSpeed = 0;\r\n            this.stopMove();\r\n        }\r\n        if (this.node.x + this.node.width/2 >= this.node.parent.width / 2) {\r\n            this.xSpeed = 0;\r\n            \r\n        }\r\n    }\r\n\r\n\r\n}\r\n"]}